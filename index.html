<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>MindAR + Three.js Image Tracking</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

<style>
  html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
    background: transparent;
  }
  #container {
    width: 100%;
    height: 100%;
    position: relative;
  }
</style>

<!-- MindAR + Three.js -->
<script src="https://unpkg.com/mind-ar@1.2.5/dist/mindar-image-three.prod.js"></script>
</head>

<body>
<div id="container"></div>

<script>
(async () => {

  const container = document.querySelector("#container");

  // 1️⃣ MindAR setup
  const mindarThree = new window.MINDAR.IMAGE.MindARThree({
    container: container,
    imageTargetSrc: "./target.mind",
    maxTrack: 1,
    uiScanning: true,
    uiLoading: true
  });

  const { renderer, scene, camera } = mindarThree;

  // 2️⃣ نور
  const light = new THREE.HemisphereLight(0xffffff, 0xbbbbff, 1.2);
  scene.add(light);

  // 3️⃣ Anchor (ایمیج تارگت اول)
  const anchor = mindarThree.addAnchor(0);

  // 4️⃣ آبجکت سه‌بعدی (تست)
  const geometry = new THREE.BoxGeometry(0.3, 0.3, 0.3);
  const material = new THREE.MeshStandardMaterial({ color: 0xff0000 });
  const cube = new THREE.Mesh(geometry, material);
  cube.position.set(0, 0.15, 0);

  anchor.group.add(cube);

  // 5️⃣ انیمیشن
  const clock = new THREE.Clock();

  // 6️⃣ استارت AR
  await mindarThree.start();

  renderer.setAnimationLoop(() => {
    const delta = clock.getDelta();
    cube.rotation.y += delta;
    cube.rotation.x += delta * 0.5;

    renderer.render(scene, camera);
  });

})();
</script>
</body>
</html>
